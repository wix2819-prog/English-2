<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>اختبار تفاعلي — عربي ↔ English (موسع)</title>
  <style>
    :root{font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;}
    body{margin:0;padding:18px;background:#f3f6ff;color:#0b1320;}
    .container{max-width:980px;margin:0 auto;background:#fff;border-radius:12px;padding:18px;box-shadow:0 10px 30px rgba(16,24,64,0.06);}
    h1{margin:0 0 6px;font-size:20px;text-align:center;}
    p.lead{margin:6px 0 14px;text-align:center;color:#344055;}
    .tabs{display:flex;gap:8px;justify-content:center;margin-bottom:12px;flex-wrap:wrap;}
    .tab{padding:8px 14px;border-radius:9px;border:1px solid #e6ecff;background:#fff;cursor:pointer;font-weight:700;}
    .tab.active{background:#2b6df6;color:#fff;border-color:transparent;box-shadow:0 8px 20px rgba(43,109,246,0.14);}
    .quiz{direction:rtl;}
    .section-select{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-bottom:12px;}
    .section-btn{padding:6px 10px;border-radius:8px;border:1px solid #e9eefc;background:#fff;cursor:pointer;}
    .section-btn.active{background:#eef5ff;border-color:transparent;}
    .question{border:1px solid #eef3ff;padding:12px;border-radius:10px;margin-bottom:12px;background:linear-gradient(180deg,#fff,#fbfdff);}
    .q-text{font-weight:800;margin-bottom:10px;font-size:16px;}
    .options{display:flex;flex-direction:column;gap:8px;}
    .opt{padding:12px;border-radius:9px;border:1px solid #e7eefc;background:#fff;cursor:pointer;user-select:none;font-weight:600;box-shadow:0 2px 6px rgba(10,14,40,0.03);}
    .opt.correct{border-color:#2ecc71;background:#eafff0;}
    .opt.wrong{border-color:#ff6b6b;background:#fff6f6;}
    .feedback{margin-top:8px;font-weight:700;color:#223;}
    .controls{display:flex;gap:8px;justify-content:flex-end;margin-top:8px;flex-wrap:wrap;}
    button{padding:10px 14px;border-radius:10px;border:0;background:#2b6df6;color:#fff;cursor:pointer;font-weight:700;}
    button.secondary{background:#6b7280;}
    .score{font-size:15px;font-weight:800;margin-top:12px;text-align:left;}
    .small{font-size:13px;color:#5a6b85;margin-top:6px;}
    footer{margin-top:18px;font-size:13px;color:#6b7280;text-align:center;padding-bottom:12px;}
    @media (max-width:700px){
      .controls{justify-content:center;}
      .q-text{font-size:15px;}
      .opt{font-size:15px;padding:10px;}
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>اختبار تفاعلي — عربي ↔ English (موسع)</h1>
    <p class="lead">أضفت مجموعة جديدة: <strong>عائلة وفواكه</strong>. اختر الترجمة الصحيحة في كلا الاتجاهين.</p>

    <div class="tabs" role="tablist" aria-label="quiz tabs">
      <div class="tab active" id="tab-ar" role="tab" tabindex="0">من العربية إلى الإنجليزية</div>
      <div class="tab" id="tab-en" role="tab" tabindex="0">From English to Arabic</div>
    </div>

    <div class="section-select" aria-label="sections">
      <button class="section-btn active" data-section="core">الكلمات الأساسية</button>
      <button class="section-btn" data-section="family-fruits">عائلة & فواكه (جديد)</button>
      <button class="section-btn" data-section="all">كل الأسئلة</button>
    </div>

    <div id="quiz" class="quiz" aria-live="polite"></div>

    <div class="controls">
      <button id="shuffleBtn" class="secondary">إعادة ترتيب</button>
      <button id="showScoreBtn">عرض النتيجة</button>
      <button id="resetBtn" class="secondary">إعادة ضبط</button>
    </div>

    <div id="result" class="score" aria-atomic="true"></div>
    <p class="small">طريقة الاستخدام: اضغط على تبويب لاختيار اتجاه الأسئلة، ثم اختر القسم (الكلمات الأساسية، العائلة & الفواكه، أو الكل). اضغط على الإجابات لتحصل على تلوين فوري.</p>
    <footer>يمكنك حفظ الصفحة وتشغيلها على جوالك أو رفعها على GitHub Pages كما شرحنا سابقًا.</footer>
  </div>

<script>
// بيانات الأسئلة المحدثة (تضم المجموعة القديمة + المجموعة الجديدة)
const datasets = {
  core_arToEn: [
    {arabic: "أب", correct: "Father", options: ["Father","Neighbor","Carpenter","Butcher"]},
    {arabic: "محاسب", correct: "Accountant", options: ["Actor","Accountant","Baker","Uncle"]},
    {arabic: "عم", correct: "Uncle", options: ["Author","Uncle","Butcher","Burglar"]},
    {arabic: "ممثل", correct: "Actor", options: ["Actor","Carpenter","Baker","Author"]},
    {arabic: "عمة", correct: "Aunt", options: ["Aunt","Actress","Father","Neighbor"]},
    {arabic: "ممثلة", correct: "Actress", options: ["Actress","Burglar","Accountant","Butcher"]},
    {arabic: "مؤلف", correct: "Author", options: ["Author","Carpenter","Uncle","Baker"]},
    {arabic: "خباز", correct: "Baker", options: ["Baker","Actor","Father","Burglar"]},
    {arabic: "جار", correct: "Neighbor", options: ["Neighbor","Butcher","Accountant","Actress"]},
    {arabic: "جزار", correct: "Butcher", options: ["Carpenter","Butcher","Author","Uncle"]},
    {arabic: "لص منازل", correct: "Burglar", options: ["Burglar","Baker","Actor","Father"]},
    {arabic: "نجار", correct: "Carpenter", options: ["Carpenter","Actress","Neighbor","Author"]}
  ],
  core_enToAr: [
    {english: "Father", correct: "أب", options: ["أب","عمة","مؤلف","خباز"]},
    {english: "Accountant", correct: "محاسب", options: ["ممثل","محاسب","نجار","جار"]},
    {english: "Uncle", correct: "عم", options: ["عمة","عم","جزار","لص منازل"]},
    {english: "Actor", correct: "ممثل", options: ["ممثل","مؤلف","أب","خباز"]},
    {english: "Aunt", correct: "عمة", options: ["عمة","ممثلة","خَبّاز","محاسب"]},
    {english: "Actress", correct: "ممثلة", options: ["نجار","ممثلة","جار","جزار"]},
    {english: "Author", correct: "مؤلف", options: ["أب","مؤلف","بِكَر","لص منازل"]},
    {english: "Baker", correct: "خباز", options: ["خباز","ممثلة","أخ","نجار"]},
    {english: "Neighbor", correct: "جار", options: ["جار","مؤلف","عمة","جزار"]},
    {english: "Butcher", correct: "جزار", options: ["جزار","أب","نجار","مؤلف"]},
    {english: "Burglar", correct: "لص منازل", options: ["لص منازل","مؤلف","خباز","عمة"]},
    {english: "Carpenter", correct: "نجار", options: ["عم","نجار","ممثلة","جزار"]}
  ],
  family_arToEn: [
    {arabic: "مجرم", correct: "Criminal", options: ["Police officer","Criminal","Cousin (male)","Son"]},
    {arabic: "ضابط شرطة", correct: "Police officer", options: ["Pear","Police officer","Grandson","Lemon"]},
    {arabic: "ابن العم", correct: "Cousin (male)", options: ["Cousin (male)","Niece","Father-in-law","Baker"]},
    {arabic: "ابنه", correct: "His son", options: ["His son","Mother-in-law","Cherry","Granddaughter"]},
    {arabic: "ابن", correct: "Son", options: ["Son","Grandson","Stepfather","Peach"]},
    {arabic: "ابنة الاخ", correct: "Niece", options: ["Niece","Nephew","Pear","Lime"]},
    {arabic: "ابن الاخ", correct: "Nephew", options: ["Nephew","Niece","Parents","Stepmother"]},
    {arabic: "حفيد", correct: "Grandson", options: ["Grandson","Granddaughter","Father","Carpenter"]},
    {arabic: "حفيدة", correct: "Granddaughter", options: ["Granddaughter","Grandson","Neighbor","Butcher"]},
    {arabic: "زوج الام", correct: "Stepfather", options: ["Stepfather","Father-in-law","Criminal","Actor"]},
    {arabic: "زوجة الاب", correct: "Stepmother", options: ["Stepmother","Aunt","Mother-in-law","Actress"]},
    {arabic: "ام الروجة", correct: "Mother-in-law", options: ["Mother-in-law","Wife","Grandparents","His son"]},
    {arabic: "ابو الزوج", correct: "Father-in-law", options: ["Father-in-law","Son","Lime","Tangerine"]},
    {arabic: "الولدين", correct: "Parents", options: ["Parents","Children","Fruit","Neighbor"]},
    {arabic: "الجدين", correct: "Grandparents", options: ["Grandparents","Grandchildren","Criminal","Uncle"]}
  ],
  family_enToAr: [
    {english: "Criminal", correct: "مجرم", options: ["مجرم","مؤلف","خباز","جار"]},
    {english: "Police officer", correct: "ضابط شرطة", options: ["ابن","ضابط شرطة","حبق","زوج الام"]},
    {english: "Cousin (male)", correct: "ابن العم", options: ["ابن العم","حفيد","جزار","ابنه"]},
    {english: "His son", correct: "ابنه", options: ["أب","ابنه","أم","زوجة الاب"]},
    {english: "Son", correct: "ابن", options: ["ابن","حفيدة","كرز","مجرم"]},
    {english: "Niece", correct: "ابنة الاخ", options: ["ابنة الاخ","ابن الاخ","جدين","زوج الام"]},
    {english: "Nephew", correct: "ابن الاخ", options: ["ابن الاخ","ام الروجة","مؤلف","بطيخ"]},
    {english: "Grandson", correct: "حفيد", options: ["حفيد","زوجة الاب","نجار","عنب"]},
    {english: "Granddaughter", correct: "حفيدة", options: ["حفيدة","عم","ممثلة","كرز"]},
    {english: "Stepfather", correct: "زوج الام", options: ["زوج الام","أب","خَبّاز","زوجة الاب"]},
    {english: "Stepmother", correct: "زوجة الاب", options: ["زوجة الاب","عمة","اب","أم الروجة"]},
    {english: "Mother-in-law", correct: "ام الروجة", options: ["ام الروجة","جار","كرز","مجرم"]},
    {english: "Father-in-law", correct: "ابو الزوج", options: ["ابو الزوج","أخ","مؤلف","لص منازل"]},
    {english: "Parents", correct: "الوالدين", options: ["الوالدين","الطفل","فاكهة","جزار"]},
    {english: "Grandparents", correct: "الجدين", options: ["الجدين","ابن","زوج الام","محاسب"]}
  ],
  fruits_arToEn: [
    {arabic: "اناناس", correct: "Pineapple", options: ["Cherry","Pineapple","Pear","Lime"]},
    {arabic: "البرقوق", correct: "Plum", options: ["Strawberry","Watermelon","Plum","Peach"]},
    {arabic: "فراولة", correct: "Strawberry", options: ["Pear","Strawberry","Grapes","Cherry"]},
    {arabic: "بطيخ", correct: "Watermelon", options: ["Lemon","Tangerine","Watermelon","Apple"]},
    {arabic: "الخوخ", correct: "Peach", options: ["Peach","Cherry","Plum","Pear"]},
    {arabic: "كمثرى", correct: "Pear", options: ["Pear","Lime","Strawberry","Grapes"]},
    {arabic: "عنب", correct: "Grapes", options: ["Banana","Grapes","Cherry","Apple"]},
    {arabic: "ليمون", correct: "Lemon", options: ["Lemon","Lime","Pineapple","Peach"]},
    {arabic: "ليمون اخضر", correct: "Lime", options: ["Lime","Lemon","Tangerine","Watermelon"]},
    {arabic: "يوسف فندي", correct: "Mandarin", options: ["Mandarin","Pineapple","Cherry","Pear"]},
    {arabic: "كرز", correct: "Cherry", options: ["Cherry","Strawberry","Grapes","Pear"]},
    {arabic: "فاكهة", correct: "Fruit", options: ["Fruit","Parents","Son","Criminal"]}
  ],
  fruits_enToAr: [
    {english: "Pineapple", correct: "اناناس", options: ["اناناس","بطيخ","كرز","محاسب"]},
    {english: "Plum", correct: "البرقوق", options: ["الخوخ","البرقوق","ليمون","مجرم"]},
    {english: "Strawberry", correct: "فراولة", options: ["فراولة","ابن","عنب","الجدين"]},
    {english: "Watermelon", correct: "بطيخ", options: ["بطيخ","نجار","كرز","زوج الام"]},
    {english: "Peach", correct: "الخوخ", options: ["الخوخ","مؤلف","كمثرى","ام الروجة"]},
    {english: "Pear", correct: "كمثرى", options: ["كمثرى","ليمون","ممثلة","ابنة الاخ"]},
    {english: "Grapes", correct: "عنب", options: ["فاكهة","عنب","ابن","جزار"]},
    {english: "Lemon", correct: "ليمون", options: ["ليمون","ام","نجار","ابو الزوج"]},
    {english: "Lime", correct: "ليمون اخضر", options: ["ليمون اخضر","كرز","مؤلف","زوجة الاب"]},
    {english: "Mandarin", correct: "يوسف فندي", options: ["يوسف فندي","البرقوق","ابن","فاكهة"]},
    {english: "Cherry", correct: "كرز", options: ["كرز","فراولة","ابنة الاخ","ابن"]},
    {english: "Fruit", correct: "فاكهة", options: ["فاكهة","الوالدين","اناناس","جذر"]}
  ]
};

// Utility functions
function shuffleArray(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } }
function buildList(mode, section){
  let list = [];
  if(section === "core" || section === "all"){
    if(mode==="ar") list = list.concat(datasets.core_arToEn);
    else list = list.concat(datasets.core_enToAr);
  }
  if(section === "family-fruits" || section === "all"){
    if(mode==="ar"){
      list = list.concat(datasets.family_arToEn);
      list = list.concat(datasets.fruits_arToEn);
    } else {
      list = list.concat(datasets.family_enToAr);
      list = list.concat(datasets.fruits_enToAr);
    }
  }
  return list;
}

function createQuizPanel(mode, container, section="core"){
  const list = buildList(mode, section);
  shuffleArray(list);
  container.innerHTML = "";
  list.forEach((item, idx) => {
    const q = document.createElement("div");
    q.className = "question";
    const qText = document.createElement("div");
    qText.className = "q-text";
    if(mode==="ar"){
      qText.innerHTML = `<span>اختر الترجمة الصحيحة لكلمة:</span> <span style="font-size:18px;margin-left:8px;font-weight:900">${item.arabic}</span>`;
    } else {
      qText.innerHTML = `<span>What is the meaning of:</span> <span style="font-size:18px;margin-left:8px;font-weight:900">${item.english || item.arabic}</span>`;
    }
    q.appendChild(qText);

    const opts = document.createElement("div");
    opts.className = "options";
    // shuffle options
    if(!item.options) item.options = [item.correct];
    shuffleArray(item.options);
    item.options.forEach(optText => {
      const opt = document.createElement("div");
      opt.className = "opt";
      opt.tabIndex = 0;
      opt.setAttribute("role","button");
      opt.textContent = optText;
      opt.addEventListener("click", ()=> handleSelect(opt, item.correct, container));
      opt.addEventListener("keypress", (e)=>{ if(e.key==="Enter") handleSelect(opt, item.correct, container); });
      opts.appendChild(opt);
    });

    q.appendChild(opts);
    container.appendChild(q);
  });
  document.getElementById("result").textContent = "";
}

function handleSelect(optElem, correctAnswer, container){
  const parent = optElem.closest(".question");
  if(parent.classList.contains("answered")) return;
  parent.classList.add("answered");
  const options = parent.querySelectorAll(".opt");
  options.forEach(o => {
    if(o.textContent === correctAnswer){
      o.classList.add("correct");
    }
    if(o === optElem && o.textContent !== correctAnswer){
      o.classList.add("wrong");
    }
    o.style.pointerEvents = "none";
  });
  const fb = document.createElement("div");
  fb.className = "feedback";
  fb.textContent = (optElem.textContent === correctAnswer) ? "إجابة صحيحة ✅" : `إجابة خاطئة ❌ — الإجابة الصحيحة: ${correctAnswer}`;
  parent.appendChild(fb);
  updateResult(container);
}

function updateResult(container){
  const total = container.querySelectorAll(".question").length;
  let answered = 0;
  let chosenCorrect = 0;
  container.querySelectorAll(".question").forEach(q => {
    const chosen = Array.from(q.querySelectorAll(".opt")).find(o => o.style.pointerEvents === "none" && (o.classList.contains("wrong") || o.classList.contains("correct")));
    if(chosen){ answered++; if(chosen.classList.contains("correct")) chosenCorrect++; }
  });
  const resultEl = document.getElementById("result");
  resultEl.textContent = `الإجابات المختارة: ${answered} من ${total} — صحيحة: ${chosenCorrect}`;
}

// Initialization
const quizDiv = document.getElementById("quiz");
const tabAr = document.getElementById("tab-ar");
const tabEn = document.getElementById("tab-en");
let mode = "ar"; // 'ar' or 'en'
let currentSection = "core";
createQuizPanel(mode, quizDiv, currentSection);

// event listeners
tabAr.addEventListener("click", ()=> { mode="ar"; tabAr.classList.add("active"); tabEn.classList.remove("active"); createQuizPanel(mode, quizDiv, currentSection); });
tabEn.addEventListener("click", ()=> { mode="en"; tabEn.classList.add("active"); tabAr.classList.remove("active"); createQuizPanel(mode, quizDiv, currentSection); });

document.querySelectorAll(".section-btn").forEach(btn => {
  btn.addEventListener("click", ()=>{
    document.querySelectorAll(".section-btn").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    currentSection = btn.getAttribute("data-section");
    createQuizPanel(mode, quizDiv, currentSection);
  });
});

document.getElementById("shuffleBtn").addEventListener("click", ()=> createQuizPanel(mode, quizDiv, currentSection));
document.getElementById("resetBtn").addEventListener("click", ()=> createQuizPanel(mode, quizDiv, currentSection));

document.getElementById("showScoreBtn").addEventListener("click", ()=> {
  const total = quizDiv.querySelectorAll(".question").length;
  let chosenCorrect = 0;
  let answered = 0;
  quizDiv.querySelectorAll(".question").forEach(q => {
    const chosen = Array.from(q.querySelectorAll(".opt")).find(o => o.style.pointerEvents === "none" && (o.classList.contains("wrong") || o.classList.contains("correct")));
    if(chosen){ answered++; if(chosen.classList.contains("correct")) chosenCorrect++; }
  });
  alert(`النتيجة:\nالإجابات المختارة: ${answered} من ${total}\nالإجابات الصحيحة: ${chosenCorrect}`);
});

// keyboard support for tabs and options
[tabAr, tabEn].forEach(tab => tab.addEventListener("keydown", (e)=>{ if(e.key==="Enter"||e.key===" ") tab.click(); }));

</script>
</body>
</html>
